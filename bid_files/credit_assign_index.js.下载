require(["domReady!","jquery","scrollup","ui-helper","common","jquery-validate","jquery-validate-unobtrusive","validate-patch"],function(t,a,e,n,r){function i(){EDEN_UI_HELPER.HookResponsiveTable(),r()}function s(t){var e=parseFloat(a("#creditAssignData").attr("data-sell-amount")),n=parseFloat(a("#creditAssignData").attr("data-credit-assign-amount")),r=0;return e>0&&(r=t*n/e),r=100*r-parseInt(100*r)>=.5?parseInt(100*r)/100+.01:parseInt(100*r)/100,r.toFixed(2)}i();var o=function(t){var e=parseFloat(a("#InvestAmount").val()),n=parseFloat(a("#creditAssignData").attr("data-min-bid-amount")),r=parseFloat(a("#creditAssignData").attr("data-investment-balance")),i=parseFloat(a("#creditAssignData").attr("data-sell-amount"));if(e>=n&&e<=r){var s=parseFloat(a("#creditAssignData").attr("data-expected-earning-amount")),o=parseFloat(a("#creditAssignData").attr("data-credit-assign-amount")),l=parseFloat(a("#creditAssignData").attr("data-principal-amount")),u=0;l>0&&(u=e*s/l,u=parseInt(100*u)/100);var d=0;o>0&&(d=e*i/o,d=parseInt(100*d)/100),a("#ExpectedEarning").html(a.format(u.toFixed(2),3,",")),a("#Deal").html(a.format(d.toFixed(2),3,","));var c=parseFloat(a("#creditAssignData").attr("data-total-discount-amount")),p=parseFloat(a("#creditAssignData").attr("data-credit-assign-amount")),m=e*c/p;if(m=100*m-parseInt(100*m)>=.5?parseInt(100*m)/100+.01:parseInt(100*m)/100,a("#discountAmount").html(a.format(m.toFixed(2),3,",")),1==t){var v=a("#invest-tip");v.find(".investAmount").empty().html(a.format(d.toFixed(2),3,",")),"none"==v.css("display")&&v.fadeIn()}}else a("#ExpectedEarning").html("--"),a("#Deal").html("--"),a("#discountAmount").html("--"),a("#invest-tip").hide()};a.extend({format:function(t,a,e){var n=parseFloat(t);n<0&&(t=Math.abs(t)),t=t.toString();var r,i=t.indexOf(".");i!=-1&&(r=t.substring(i,t.length),t=t.substring(0,i));var s=t.length;if(s>a){var o=s%a,l=parseInt(s/a),u=[],d=t.substr(0,o);""!=d&&u.push(d);for(var c=0;c<l;c++)u.push(t.substr(o+c*a,a));t=u.join(e)}return t=i==-1?t:t+r,n<0?"-"+t:t}}),a("#act_project_all_in").on("click",function(t){t.preventDefault();var e=a("#InvestAmount"),n=a(this).attr("data-user-avaliable"),r=a(this).attr("data-avaliable"),i=s(n);parseFloat(i)<parseFloat(r)&&Math.abs(i-r)>.01&&(r=i),e.val(r),o()}),o();var l;a("#InvestAmount").on("keyup",function(){o(!0)}).on("blur",function(){l=setTimeout(function(){a("#invest-tip").fadeOut()},1e3)}).on("focus",function(){clearTimeout(l),o(!0)}),a("#act_project_invest").click(function(){return!!a("#CreditAssign").valid()&&(a(this).hide(),void a(".submitting").show())})});